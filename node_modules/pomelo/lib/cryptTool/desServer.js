var crypto = require('crypto');
var exp = module.exports;
//加密
exp.cipher = function(key, buf){
    var encrypted = "";
    var cip = crypto.createCipheriv('des', key, key);
    try{
        encrypted += cip.update(buf, 'utf8', 'base64');
        encrypted += cip.final('base64');
    }catch(e){
        console.error('------des cipher exp--------: ' + e);
    }

    return (encrypted);
};

//解密
exp.decipher = function(key, encrypted){
    var decrypted = "";
    var decipher = crypto.createDecipheriv('des', key, key);
    try{
        decrypted += decipher.update(encrypted, 'base64', 'utf8');
        decrypted += decipher.final('utf8');
    }catch(e){
        console.error('------des decipher exp--------: ' + e);
        return JSON.stringify({});
    }
    return (decrypted);
};
